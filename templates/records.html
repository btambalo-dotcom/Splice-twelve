{% extends 'base.html' %}{% block content %}
<h3>Registros</h3>
<form method="get" class="row g-2 align-items-end mb-3">
  <div class="col-sm-2"><label class="form-label">De</label><input class="form-control" type="date" name="start" value="{{ start or '' }}"></div>
  <div class="col-sm-2"><label class="form-label">Até</label><input class="form-control" type="date" name="end" value="{{ end or '' }}"></div>
  <div class="col-sm-2"><label class="form-label">Map</label><input class="form-control" name="map" value="{{ map or '' }}" placeholder="contém..."></div>
  <div class="col-sm-2"><label class="form-label">Type</label><input class="form-control" name="type" value="{{ type or '' }}" placeholder="contém..."></div>
  <div class="col-sm-2"><label class="form-label">Device</label><input class="form-control" name="device" value="{{ device or '' }}" placeholder="contém..."></div>
  <div class="col-sm-2"><button class="btn btn-primary w-100">Filtrar</button></div>
</form>

<div class="card p-2 alt">
  <div class="table-responsive" style="max-height:70vh">
    <table class="table table-sm table-dark">
      <thead><tr><th>ID</th><th>Data</th><th>Map</th><th>Type</th><th>Device</th><th>Splices</th><th>Total ($)</th><th class="text-end">Ações</th></tr></thead>
      <tbody>
        {% for r in rows %}
        <tr>
          <td>{{ r.id }}</td>
          <td>{{ r.created_date.date() if r.created_date else '' }}</td>
          <td>{{ r.map }}</td>
          <td>{{ r.type }}</td>
          <td>{{ r.device }}</td>
          <td>{{ r.splices }}</td>
          <td>$ {{ '%.2f'|format(r.total_usd or 0) }}</td>
          <td class="text-end"><a class="btn btn-sm btn-danger" href="{{ url_for('record_delete', rid=r.id, next='records') }}">Excluir</a></td>
        </tr>
        {% else %}
        <tr><td colspan="8" class="text-secondary">Nenhum registro encontrado.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<div class="mt-3 d-flex gap-2">
  <a class="btn btn-success" href="{{ url_for('export_report_xlsx', start=start, end=end) }}">Exportar Relatório (Excel)</a>
  <a class="btn btn-success" href="{{ url_for('export_report_pdf', start=start, end=end) }}">Exportar Relatório (PDF)</a>
</div>
{% endblock %}