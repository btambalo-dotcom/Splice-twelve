{% extends 'base.html' %}
{% block title %}Configurações · Twelve Tech{% endblock %}
{% block content %}
<h3 class="mb-3">Configurações</h3>
<div class="row g-4">
  <div class="col-md-6">
    <div class="card p-4 shadow h-100">
      <h5>Tipos de Device (valor fixo)</h5>
      <form method="post" action="{{ url_for('add_device_type') }}" class="row g-2 mb-3 mt-1">
        <div class="col-7"><input class="form-control" name="name" placeholder="Ex.: ONT, Closure, CTO" required></div>
        <div class="col-5"><input class="form-control" name="value" type="number" step="0.01" min="0" placeholder="R$" required></div>
        <div class="col-12"><button class="btn btn-primary w-100">Salvar / Atualizar</button></div>
      </form>
      <table class="table table-sm align-middle mb-0">
        <thead><tr><th>Tipo</th><th>Valor</th><th class="text-end">Ações</th></tr></thead>
        <tbody>
        {% for t in types %}
          <tr><td>{{ t.name }}</td><td>R$ {{ '%.2f'|format(t.value) }}</td>
            <td class="text-end"><a class="btn btn-outline-danger btn-sm" href="{{ url_for('del_device_type', tid=t.id) }}">Excluir</a></td></tr>
        {% else %}
          <tr><td colspan="3" class="text-muted">Nenhum tipo cadastrado.</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  <div class="col-md-6">
    <div class="card p-4 shadow h-100">
      <h5>Faixas de Fusões</h5>
      <form method="post" action="{{ url_for('add_splice_tier') }}" class="row g-2 mb-3 mt-1">
        <div class="col-4"><input class="form-control" name="min_splices" type="number" min="0" placeholder="Mín." required></div>
        <div class="col-4"><input class="form-control" name="max_splices" type="number" min="0" placeholder="Máx. (vazio = ∞)"></div>
        <div class="col-4"><input class="form-control" name="price_per_splice" type="number" step="0.01" min="0" placeholder="R$/fusão" required></div>
        <div class="col-12"><button class="btn btn-primary w-100">Adicionar</button></div>
      </form>
      <table class="table table-sm align-middle mb-0">
        <thead><tr><th>Faixa</th><th>R$/fusão</th><th class="text-end">Ações</th></tr></thead>
        <tbody>
        {% for s in tiers %}
          <tr><td>{{ s.min_splices }} – {{ s.max_splices if s.max_splices is not none else "∞" }}</td>
              <td>R$ {{ '%.2f'|format(s.price_per_splice) }}</td>
              <td class="text-end"><a class="btn btn-outline-danger btn-sm" href="{{ url_for('del_splice_tier', tid=s.id) }}">Excluir</a></td></tr>
        {% else %}
          <tr><td colspan="3" class="text-muted">Nenhuma faixa cadastrada.</td></tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
